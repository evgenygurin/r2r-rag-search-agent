# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## üéØ –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

MCP-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ R2R (Retrieval-Augmented Generation) —Å Claude Desktop —á–µ—Ä–µ–∑ Model Context Protocol. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞:
- `search` ‚Äî –≤–µ–∫—Ç–æ—Ä–Ω—ã–π –∏ –≥—Ä–∞—Ñ-–ø–æ–∏—Å–∫ –ø–æ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π R2R
- `rag` ‚Äî –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π RAG-–∑–∞–ø—Ä–æ—Å —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç–≤–µ—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```text
r2r-rag-search-agent/
‚îú‚îÄ‚îÄ server.py           # –û—Å–Ω–æ–≤–Ω–æ–π MCP —Å–µ—Ä–≤–µ—Ä (FastMCP)
‚îú‚îÄ‚îÄ pyproject.toml      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (uv)
‚îú‚îÄ‚îÄ uv.lock            # Lock-—Ñ–∞–π–ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
‚îú‚îÄ‚îÄ .python-version    # –í–µ—Ä—Å–∏—è Python (3.12)
‚îú‚îÄ‚îÄ Makefile           # –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
‚îú‚îÄ‚îÄ .env               # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ git)
‚îú‚îÄ‚îÄ .env.example       # –®–∞–±–ª–æ–Ω –¥–ª—è .env
‚îú‚îÄ‚îÄ .gitignore         # –ò—Å–∫–ª—é—á–µ–Ω–∏—è –¥–ª—è git
‚îú‚îÄ‚îÄ CLAUDE.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è Claude Code
‚îî‚îÄ‚îÄ README.md          # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

**–ü–æ—á–µ–º—É FastMCP –≤–º–µ—Å—Ç–æ –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ MCP SDK:**
- FastMCP —É–ø—Ä–æ—â–∞–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- server.py:98-110 ‚Äî –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è FastMCP —Å–µ—Ä–≤–µ—Ä–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (server.py:16-94):**
- `format_search_results_for_llm()` –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç 4 —Ç–∏–ø–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:
  - Chunk search (–≤–µ–∫—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –ø–æ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞–º)
  - Graph search (–≥—Ä–∞—Ñ —Å—É—â–Ω–æ—Å—Ç–µ–π/–æ—Ç–Ω–æ—à–µ–Ω–∏–π)
  - Web search (–ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ)
  - Document search (–ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã —Å —á–∞–Ω–∫–∞–º–∏)
- –ö–æ—Ä–æ—Ç–∫–∏–µ ID —á–µ—Ä–µ–∑ `id_to_shorthand()` –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ (–ø–µ—Ä–≤—ã–µ 7 —Å–∏–º–≤–æ–ª–æ–≤)

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### Makefile –∫–æ–º–∞–Ω–¥—ã (–ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±)

```bash
make install    # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (production + dev) —á–µ—Ä–µ–∑ uv
make sync       # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ pyproject.toml
make dev        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
make lint       # –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (format + typecheck)
make fix        # –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ruff –ø—Ä–æ–±–ª–µ–º
make format     # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ ruff
make typecheck  # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ mypy
make run        # –ó–∞–ø—É—Å–∫ MCP —Å–µ—Ä–≤–µ—Ä–∞ —á–µ—Ä–µ–∑ uv run
make clean      # –û—á–∏—Å—Ç–∫–∞ –∫—ç—à–∞ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
make help       # –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
```

**–í–∞–∂–Ω–æ:** –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `uv` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º –æ–∫—Ä—É–∂–µ–Ω–∏–µ–º. –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `uv run`.

### –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞

```bash
# –ß–µ—Ä–µ–∑ Makefile (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)
make run

# –ß–µ—Ä–µ–∑ MCP —É—Å—Ç–∞–Ω–æ–≤–∫—É (–¥–ª—è production)
mcp install server.py -v R2R_BASE_URL=http://localhost:7272

# –ü—Ä—è–º–æ–π –∑–∞–ø—É—Å–∫
python server.py
```

**–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å `mcp install`:**

–ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—à—å –æ—à–∏–±–∫—É `RuntimeError: Type not yet supported: str | None`:
```bash
# –û–±–Ω–æ–≤–∏ typer –¥–æ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ–π –≤–µ—Ä—Å–∏–∏
pip install --upgrade 'mcp[cli]'

# –ó–∞—Ç–µ–º –ø–æ–≤—Ç–æ—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É
mcp install server.py -v R2R_BASE_URL=http://your-r2r-url:7272
```

–≠—Ç–æ –æ–±–Ω–æ–≤–∏—Ç typer —Å –≤–µ—Ä—Å–∏–∏ 0.9.0 –¥–æ 0.20.0+, —á—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç –ø—Ä–æ–±–ª–µ–º—É —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π `.env` —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:
```bash
R2R_BASE_URL=http://your-r2r-instance:7272
API_KEY=your_r2r_api_key
PYTHONWARNINGS=ignore::DeprecationWarning
```
**–í–∞–∂–Ω–æ:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –∫–∞–≤—ã—á–∫–∏ –≤ .env —Ñ–∞–π–ª–µ –¥–ª—è PYTHONWARNINGS - —ç—Ç–æ –≤—ã–∑–æ–≤–µ—Ç –æ—à–∏–±–∫—É "Invalid -W option".

**–í–ê–ñ–ù–û:** `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏—Å–∫–ª—é—á–µ–Ω –∏–∑ git

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ß–µ—Ä–µ–∑ Makefile (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è) - —Å–æ–∑–¥–∞—Å—Ç .venv –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
make install

# –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ uv
uv sync --all-extras

# –¢–æ–ª—å–∫–æ production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv sync

# –¢–æ–ª—å–∫–æ dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
uv sync --extra dev
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (pyproject.toml):**
- **Production:** fastmcp==2.13.1 (–∑–∞–∫—Ä–µ–ø–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è –¥–ª—è production), r2r>=3.6.0
- **Dev:** ruff>=0.8.0, mypy>=1.14.0

**–í–ê–ñ–ù–û:** FastMCP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞–∫—Ä–µ–ø–ª—ë–Ω–Ω—É—é –≤–µ—Ä—Å–∏—é (==2.13.1) –ø–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ FastMCP, —Ç.–∫. breaking changes –º–æ–≥—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –≤ minor –≤–µ—Ä—Å–∏—è—Ö. uv.lock –≤–∫–ª—é—á—ë–Ω –≤ git –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ production –æ–∫—Ä—É–∂–µ–Ω–∏–∏.

–í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤ `.venv/` –∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ `uv`.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞

```bash
# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ + —Ç–∏–ø—ã)
make lint

# –¢–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make format

# –¢–æ–ª—å–∫–æ —Ç–∏–ø—ã
make typecheck

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
make fix
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤ Claude Desktop, –ø—Ä–æ–≤–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å:
1. –û—Ç–∫—Ä–æ–π Claude Desktop
2. –ü—Ä–æ–≤–µ—Ä—å Tools ‚Üí –¥–æ–ª–∂–Ω—ã –ø–æ—è–≤–∏—Ç—å—Å—è `search` –∏ `rag`
3. –¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: "Search for information about X"

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å R2R

### R2RClient –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

- –ö–ª–∏–µ–Ω—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (server.py:124, 145)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `.env`
- –ë–∞–∑–æ–≤—ã–π URL: `R2R_BASE_URL` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é http://localhost:7272)

### –¢–∏–ø—ã –ø–æ–∏—Å–∫–æ–≤—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

**Vector Search (chunk_search_results):**
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã —Ç–µ–∫—Å—Ç–∞ —Å ID –∏ —Å–æ–¥–µ—Ä–∂–∏–º—ã–º
- –§–æ—Ä–º–∞—Ç: `Source ID [–∫—Ä–∞—Ç–∫–∏–π_id]: —Ç–µ–∫—Å—Ç`

**Graph Search (graph_search_results):**
- –¢—Ä–∏ —Ç–∏–ø–∞ –æ–±—ä–µ–∫—Ç–æ–≤:
  - Communities (id, name, summary)
  - Entities (name, description)
  - Relationships (subject-predicate-object)

**Web Search (web_search_results):**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: title, link, snippet
- –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –≤–µ–±-–∏—Å—Ç–æ—á–Ω–∏–∫–∏

**Document Search (document_search_results):**
- –î–æ–∫—É–º–µ–Ω—Ç—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏ (title, summary)
- –í–ª–æ–∂–µ–Ω–Ω—ã–µ chunks —Å ID –∏ —Ç–µ–∫—Å—Ç–æ–º
- –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –Ω—é–∞–Ω—Å—ã

### –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ DeprecationWarning

server.py:5-7 —è–≤–Ω–æ –æ—Ç–∫–ª—é—á–∞–µ—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º:
```python
os.environ["PYTHONWARNINGS"] = "ignore::DeprecationWarning"
warnings.filterwarnings("ignore", category=DeprecationWarning)
```

**–ü—Ä–∏—á–∏–Ω–∞:** R2R SDK –∏–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç deprecation warnings, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞—Å–æ—Ä—è—é—Ç –ª–æ–≥–∏ MCP

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

- ImportError –¥–ª—è MCP (server.py:104-106) —Å –ø–æ–Ω—è—Ç–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –ù–ï–¢ —è–≤–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ R2R API ‚Äî –∫–ª–∏–µ–Ω—Ç –±—Ä–æ—Å–∏—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
- –ü—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –¥–æ–±–∞–≤—å try/except –≤ `search()` –∏ `rag()` –¥–ª—è production-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### –¢–∏–ø–∏–∑–∞—Ü–∏—è –∏ async

- –í—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã MCP –æ–±—ä—è–≤–ª–µ–Ω—ã –∫–∞–∫ `async` (server.py:114, 135)
- R2RClient –º–µ—Ç–æ–¥—ã —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ, –Ω–æ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ async —Ñ—É–Ω–∫—Ü–∏–π
- FastMCP –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ R2R

```python
from r2r import R2RClient
client = R2RClient()
result = client.retrieval.search(query="test")
print(result)
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ MCP

FastMCP –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ stderr Claude Desktop

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

1. **`RuntimeError: Type not yet supported: str | None`** –ø—Ä–∏ `mcp install`
   - **–ü—Ä–∏—á–∏–Ω–∞:** –°—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è typer (0.9.0) –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–∞ —Å —Ç–µ–∫—É—â–∏–º MCP CLI
   - **–†–µ—à–µ–Ω–∏–µ:** `pip install --upgrade 'mcp[cli]'` (–æ–±–Ω–æ–≤–∏—Ç typer –¥–æ 0.20.0+)

2. **"R2R connection refused"** ‚Üí –ø—Ä–æ–≤–µ—Ä—å `R2R_BASE_URL` –≤ `.env` –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è

3. **"MCP tool not appearing"** ‚Üí –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ Claude Desktop (Cmd+Q, –∑–∞—Ç–µ–º –æ—Ç–∫—Ä–æ–π)

4. **Empty search results** ‚Üí –ø—Ä–æ–≤–µ—Ä—å, —á—Ç–æ R2R –±–∞–∑–∞ –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞

## üìù Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

1. –î–æ–±–∞–≤—å —Ñ—É–Ω–∫—Ü–∏—é —Å –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–æ–º `@mcp.tool()`
2. –£–∫–∞–∂–∏ docstring —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ UI Claude)
3. –î–æ–±–∞–≤—å —Ç–∏–ø—ã –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ MCP —Å–µ—Ä–≤–µ—Ä

### –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `format_search_results_for_llm()`:
- –°–æ—Ö—Ä–∞–Ω—è–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É "Source ID [shorthand]:"
- –ò—Å–ø–æ–ª—å–∑—É–π `id_to_shorthand()` –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- –¢–µ—Å—Ç–∏—Ä—É–π –Ω–∞ –≤—Å–µ—Ö 4 —Ç–∏–ø–∞—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## ‚õîÔ∏è –ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

- **–ù–ï –∫–æ–º–º–∏—Ç—å .env —Ñ–∞–π–ª** ‚Äî —Å–æ–¥–µ—Ä–∂–∏—Ç API –∫–ª—é—á–∏
- **–ù–ï —Ö–∞—Ä–¥–∫–æ–¥–∏—Ç—å R2R_BASE_URL** ‚Äî –≤—Å–µ–≥–¥–∞ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- **–ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥** –≤ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö MCP ‚Äî —Ç–æ–ª—å–∫–æ async
- **–ù–ï —É–¥–∞–ª—è—Ç—å suppression warnings** –±–µ–∑ –ø–æ–Ω–∏–º–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π

Always use context7 when I need code generation, setup or
configuration steps, or library/API documentation. This means
you should automatically use the Context7 MCP tools to resolve
library id and get library docs without me having to
explicitly ask.
